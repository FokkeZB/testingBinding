"use strict";function _typeof(a){return a&&"undefined"!=typeof Symbol&&a.constructor===Symbol?"symbol":typeof a}!function(a){if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(b.ts||(b.ts={})).httprequest=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(){k=!1,h.length?j=h.concat(j):l=-1,j.length&&e()}function e(){if(!k){var a=setTimeout(d);k=!0;for(var b=j.length;b;){for(h=j,j=[];++l<b;)h&&h[l].run();l=-1,b=j.length}h=null,k=!1,clearTimeout(a)}}function f(a,b){this.fun=a,this.array=b}function g(){}var h,i=b.exports={},j=[],k=!1,l=-1;i.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];j.push(new f(a,b)),1!==j.length||k||setTimeout(e,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.binding=function(a){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(a){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(a,b,c){(function(a){function c(){for(var a=0;a<x.length;a++)x[a][0](x[a][1]);x=[],p=!1}function d(a,b){x.push([a,b]),p||(p=!0,w(c,0))}function e(a,b){function c(a){h(b,a)}function d(a){j(b,a)}try{a(c,d)}catch(e){d(e)}}function f(a){var b=a.owner,c=b._state,d=b._data,e=a[c],f=a.then;if("function"==typeof e){c=s;try{d=e(d)}catch(i){j(f,i)}}g(f,d)||(c===s&&h(f,d),c===t&&j(f,d))}function g(a,b){var c;try{if(a===b)throw new TypeError("A promises callback cannot return that same promise.");if(b&&("function"==typeof b||"object"===("undefined"==typeof b?"undefined":_typeof(b)))){var d=b.then;if("function"==typeof d)return d.call(b,function(d){c||(c=!0,b===d?i(a,d):h(a,d))},function(b){c||(c=!0,j(a,b))}),!0}}catch(e){return c||j(a,e),!0}return!1}function h(a,b){a!==b&&g(a,b)||i(a,b)}function i(a,b){a._state===q&&(a._state=r,a._data=b,d(l,a))}function j(a,b){a._state===q&&(a._state=r,a._data=b,d(m,a))}function k(a){a._then=a._then.forEach(f)}function l(a){a._state=s,k(a)}function m(b){b._state=t,k(b),!b._handled&&v&&a.emit("unhandledRejection",b._data,b)}function n(b){a.emit("rejectionHandled",b)}function o(a){if("function"!=typeof a)throw new TypeError("Promise resolver "+a+" is not a function");if(this instanceof o==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],e(a,this)}var p,q="pending",r="settled",s="fulfilled",t="rejected",u=function(){},v="undefined"!=typeof a&&"function"==typeof a.emit,w="undefined"==typeof setImmediate?setTimeout:setImmediate,x=[];o.prototype={constructor:o,_state:q,_then:null,_data:void 0,_handled:!1,then:function(a,b){var c={owner:this,then:new this.constructor(u),fulfilled:a,rejected:b};return!b&&!a||this._handled||(this._handled=!0,this._state===t&&v&&d(n,this)),this._state===s||this._state===t?d(f,c):this._then.push(c),c.then},"catch":function(a){return this.then(null,a)}},o.all=function(a){if(!Array.isArray(a))throw new TypeError("You must pass an array to Promise.all().");return new o(function(b,c){function d(a){return g++,function(c){f[a]=c,--g||b(f)}}for(var e,f=[],g=0,h=0;h<a.length;h++)e=a[h],e&&"function"==typeof e.then?e.then(d(h),c):f[h]=e;g||b(f)})},o.race=function(a){if(!Array.isArray(a))throw new TypeError("You must pass an array to Promise.race().");return new o(function(b,c){for(var d,e=0;e<a.length;e++)d=a[e],d&&"function"==typeof d.then?d.then(b,c):b(d)})},o.resolve=function(a){return a&&"object"===("undefined"==typeof a?"undefined":_typeof(a))&&a.constructor===o?a:new o(function(b){b(a)})},o.reject=function(a){return new o(function(b,c){c(a)})},b.exports=o}).call(this,a("_process"))},{_process:1}],3:[function(a,b,c){var d=a("pinkie"),e="HTTPRequest";b.exports=function(){function a(b){var c,e,f=this,g=b.baseUrl||"http://",h=b.method||"GET";b.headers||{},b.data||{};return Object.defineProperties(this,{progressHandler:{value:b.progress,enumerable:!0},url:{value:b.url,enumerable:!0,writable:!0},method:{value:h,enumerable:!0}}),"GET"===h||"DELETE"===h?(c=a.prototype.toQueryString(b.data))&&(this.url+="?"+c):b.headers&&"application/x-www-form-urlencoded"===b.headers["Content-Type"]?this.data=a.prototype.toQueryString(b.data):b.headers&&"application/json"===b.headers["Content-Type"]?this.data=JSON.stringify(b.data):this.data=b.data,e=this.url.slice(0,5),"http:"!==e&&"https"!==e&&(this.url=g+("/"!==this.url.charAt(0)?"/":"")+this.url),new d(function(c,d){if(f.successCallback=c,f.errorCallback=d,f.httpClient=Ti.Network.createHTTPClient({onload:function(b){return function(){a.prototype.handleSuccess.call(this,b)}}(f),onerror:function(b){return function(c){a.prototype.handleError.call(this,b,c)}}(f),onsendstream:function(b){return function(c){a.prototype.handleProgress.call(this,b,c)}}(f),timeout:b.timeout||1e4}),f.httpClient.open(h,f.url),b.headers)for(var e in b.headers)f.httpClient.setRequestHeader(e,b.headers[e]);"GET"===f.method?f.httpClient.send():f.httpClient.send(f.data)})}return a.prototype.handleSuccess=function(a){Ti.API.info(e,"handleSuccess for url ("+a.method+") "+a.url);var b=this.responseText;if(this.getResponseHeader("Content-Type").match(/application\/json/))try{b=JSON.parse(b)}catch(c){return Ti.API.error(e,"Tried to parse response, but it was not valid json."),void("function"==typeof a.errorCallback&&a.errorCallback("Tried to parse response, but it was not valid json."))}"function"==typeof a.successCallback&&a.successCallback(b)},a.prototype.handleError=function(a,b){Ti.API.error(e,"handleError for url ("+a.method+") "+a.url),Ti.API.error(e,JSON.stringify(b,null,"	")),Ti.API.error(e,this.responseText),"function"==typeof a.errorCallback&&a.errorCallback(b)},a.prototype.handleProgress=function(a,b){"function"==typeof a.progressHandler&&(Ti.API.info(e,"handleProgress for url ("+a.method+") "+a.url,b.progress),a.progressHandler(b.progress))},a.prototype.toQueryString=function(a){var b,c=[],d="";for(b in a)c.push(Ti.Network.encodeURIComponent(b)+"="+Ti.Network.encodeURIComponent(a[b]));return c.length&&(d=c.join("&")),d},a}()},{pinkie:2}]},{},[3])(3)});
